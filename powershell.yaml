---
- name: powershell test
  hosts: windows
  tasks:
    - name: Run PowerShell script with parameters
      ansible.windows.win_powershell:
        script: |
          [CmdletBinding()]
          param (
              [String]
              $Path,
    
              [Switch]
              $Force
          )
    
          New-Item -Path $Path -ItemType Directory -Force:$Force
        parameters:
          Path: C:\powershelltest
          Force: true
